---
name: Documentation and Deployment
status: open
created: 2026-02-25T02:28:43Z
updated: 2026-02-25T02:41:06Z
github: https://github.com/B30780/AOI_inference_agent/issues/11
depends_on: [2, 3, 4, 5, 6, 7, 8, 9, 10]
parallel: false
conflicts_with: []
---

# Task: Documentation and Deployment

## Description
Create comprehensive documentation including setup instructions, API usage guide, troubleshooting, and deployment procedures. Ensure the system can be deployed from scratch following the documentation.

## Acceptance Criteria
- [ ] README.md with project overview and quick start guide
- [ ] SETUP.md with detailed installation and configuration instructions
- [ ] .env.example with all required environment variables documented
- [ ] Database setup guide (create database, run migrations)
- [ ] API_GUIDE.md with endpoint usage examples
- [ ] TROUBLESHOOTING.md with common issues and solutions
- [ ] CONTRIBUTING.md for future developers
- [ ] requirements.txt finalized with pinned versions
- [ ] System successfully deploys from documentation on fresh machine
- [ ] Code comments and docstrings complete

## Technical Details

**README.md:**

```markdown
# AOI Inference Agent

FastAPI-based middleware service for Automated Optical Inspection (AOI) workflows. Integrates with external SegFormer model service, manages image uploads, stores results in database, and provides comprehensive APIs for result retrieval.

## Features

- ? **Single & Batch Upload**: Upload PCB images for defect detection
- ?? **Query & Search**: Retrieve historical inspection data with filters
- ? **Download**: Get images, JSON results, and batch archives
- ?? **Swagger UI**: Interactive API documentation
- ?儭?**Web Interface**: Simple UI for uploads and visualization
- ? **Database Storage**: Persistent storage with relational schema

## Quick Start

### Prerequisites

- Python 3.9+
- PostgreSQL 14+
- Access to SegFormer service at http://140.96.77.124:8080/

### Installation

1. Clone the repository:
   ```bash
   git clone <repository-url>
   cd AOI_inference_agent
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Configure environment:
   ```bash
   cp .env.example .env
   # Edit .env with your database credentials
   ```

4. Create database:
   ```sql
   CREATE DATABASE aoi_db;
   ```

5. Run migrations:
   ```bash
   alembic upgrade head
   ```

6. Start the application:
   ```bash
   python run.py
   ```

7. Access the application:
   - Web UI: http://localhost:8000/
   - API Docs: http://localhost:8000/docs
   - API: http://localhost:8000/api/

## Project Structure

```
AOI_inference_agent/
??? app/                    # Application code
??  ??? api/               # API endpoints
??  ??? models/            # Database models and schemas
??  ??? services/          # Business logic
??  ??? static/            # Web UI assets
??? alembic/               # Database migrations
??? tests/                 # Test suite
??? data/                  # File storage
??? run.py                 # Application entry point
??? requirements.txt       # Dependencies
```

## API Endpoints

### Upload
- `POST /api/upload` - Single image upload
- `POST /api/upload/batch` - Batch upload

### Query
- `GET /api/images` - List images with pagination
- `GET /api/images/{id}` - Get image details
- `GET /api/images/{id}/classes` - Get defect classes
- `GET /api/images/{id}/regions` - Get defect regions

### Download
- `GET /api/download/image/{id}/{type}` - Download image
- `GET /api/download/json/{id}` - Download analysis JSON
- `GET /api/download/batch/{batch_id}` - Download batch ZIP

### System
- `GET /api/health` - Health check
- `GET /api/stats` - System statistics

## Documentation

- [Setup Guide](docs/SETUP.md)
- [API Guide](docs/API_GUIDE.md)
- [Troubleshooting](docs/TROUBLESHOOTING.md)
- [Contributing](CONTRIBUTING.md)

## License

MIT License
```

**SETUP.md:**

```markdown
# Setup Guide

Detailed instructions for setting up the AOI Inference Agent.

## System Requirements

- **OS**: Windows 10+, Linux, macOS
- **Python**: 3.9 or higher
- **Database**: PostgreSQL 14+ or MySQL 8+
- **Disk Space**: 50GB+ for image storage
- **RAM**: 8GB+ recommended
- **Network**: Access to http://140.96.77.124:8080/

## Installation Steps

### 1. Install Python

Download and install Python 3.9+ from https://www.python.org/

Verify installation:
```bash
python --version
```

### 2. Install PostgreSQL

**Windows:**
Download from https://www.postgresql.org/download/windows/

**Linux:**
```bash
sudo apt-get update
sudo apt-get install postgresql postgresql-contrib
```

**macOS:**
```bash
brew install postgresql
```

### 3. Create Database

Connect to PostgreSQL:
```bash
psql -U postgres
```

Create database and user:
```sql
CREATE DATABASE aoi_db;
CREATE USER aoi_user WITH PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE aoi_db TO aoi_user;
\q
```

### 4. Clone Repository

```bash
git clone <repository-url>
cd AOI_inference_agent
```

### 5. Create Virtual Environment

```bash
python -m venv venv

# Windows
venv\Scripts\activate

# Linux/macOS
source venv/bin/activate
```

### 6. Install Dependencies

```bash
pip install -r requirements.txt
```

### 7. Configure Environment

Copy example environment file:
```bash
cp .env.example .env
```

Edit `.env`:
```env
# Database
DATABASE_URL=postgresql://aoi_user:your_password@localhost:5432/aoi_db

# External Service
SEGFORMER_SERVICE_URL=http://140.96.77.124:8080/

# Storage
UPLOAD_DIR=data/uploads
RESULT_DIR=data/results

# Server
HOST=0.0.0.0
PORT=8000

# Logging
LOG_LEVEL=INFO
```

### 8. Run Migrations

```bash
alembic upgrade head
```

### 9. Start Application

```bash
python run.py
```

The application should now be running at http://localhost:8000/

## Verification

1. Check health endpoint:
   ```bash
   curl http://localhost:8000/api/health
   ```

2. Access Swagger UI:
   Open http://localhost:8000/docs in browser

3. Upload test image:
   Use Web UI at http://localhost:8000/

## Next Steps

- Read [API Guide](API_GUIDE.md) for usage examples
- See [Troubleshooting](TROUBLESHOOTING.md) for common issues
```

**.env.example:**

```env
# Database Configuration
DATABASE_URL=postgresql://aoi_user:password@localhost:5432/aoi_db

# External SegFormer Service
SEGFORMER_SERVICE_URL=http://140.96.77.124:8080/

# Storage Paths
UPLOAD_DIR=data/uploads
RESULT_DIR=data/results

# Server Configuration
HOST=0.0.0.0
PORT=8000

# Application Settings
MAX_FILE_SIZE_MB=50
MAX_BATCH_SIZE=100

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/app.log

# External Service Configuration
SEGFORMER_TIMEOUT=30
SEGFORMER_MAX_RETRIES=3
```

**API_GUIDE.md:**

Comprehensive guide with curl examples for all endpoints.

**TROUBLESHOOTING.md:**

Common issues and solutions:
- Database connection errors
- External service unreachable
- File upload failures
- Permission issues

## Dependencies
- [ ] All previous tasks completed

## Effort Estimate
- Size: M
- Hours: 8-10 hours
- Parallel: false (final task)

## Definition of Done
- [ ] All documentation files created
- [ ] README clear and complete
- [ ] Setup guide tested on fresh machine
- [ ] .env.example includes all variables
- [ ] API examples working
- [ ] Troubleshooting guide helpful
- [ ] requirements.txt finalized
- [ ] Documentation reviewed
- [ ] System deploys successfully from docs

